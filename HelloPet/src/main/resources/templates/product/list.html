<th:block th:include="@{product/_header.html}"/>
<!-- 
날짜 : 2023-03-22 ~ 2023-03-24
내용 : product list 상품 리스트 출력 구현 하기
이름 : 장인화
 -->
<script>


$(function() {
	
       
	var urlParams = new URL(location.href).searchParams;
	var cate1= urlParams.get('cate1');
	var cate2= urlParams.get('cate2');
	

	$('input[type="checkbox"]').change(function() {
		
		var isCheckDog = $('input[name=dog]').is(':checked');    	
   	   	var isCheckCat = $('input[name=cat]').is(':checked');
   	   	var type = 'all';		  
   	   	
        if(isCheckDog && isCheckCat){
        	type = 'all';
        }else if(isCheckDog && !isCheckCat) {
        	type = 'dog';
        }else if(!isCheckDog && isCheckCat) {
        	type = 'cat';
        }else if(!isCheckDog && !isCheckCat) {
        	$('.probx').empty();
        	return;
        }
   	   	   	   	
		let jsonData = {
 				 "cate1": cate1,
	        	 "cate2":cate2,
	        	 "type": type
	        	 };
        
       	console.log('jsonData : ' + JSON.stringify(jsonData));
        
        $.ajax({
        	url : '/HelloPet/product/list',
        	type: 'POST',
        	data: jsonData,
        	success : function(data) {
        		console.log(data);
        		console.log(data.p2s);
        		
        		$('.probx').empty();
        		
        		
        		
        		
        	}
        });
		
    
    });
});


</script>


<div id="productList">

    <div id="container" ng-app="appProduct" class="ng-scope">
    	<div class="div1">
	    	<h3 class="title">진료상품</h3>
	    </div>
    
        <div class="wid1200">
          <div class="lodcation">
              <span class="ic-home">
                  <a th:href="@{/index}">HOME</a>
              </span>
                  >
              <span>
                  <a th:href="@{/product/list}">진료상품</a>
              </span>
           </div>
        </div>
        
        <div class="sub-cate ng-scope" ng-controller="ProductListController">
            <ul class="depth1">
                <li th:each="cate1:${cate1s}"> 
                    <a th:href="@{/product/list(cate1=${cate1.cate1})}">[[${cate1.c1Name}]]</a>
                </li> 
               
            </ul>
            <ul class="depth2 ng-scope">
                <li th:each="selectC2:${selectC2s}">
                    <a style="cursor:pointer;" th:href="@{/product/list(cate1=${selectC2.cate1},cate2=${selectC2.cate2})}">[[${selectC2.c2Name}]]</a>
               		<input type="hidden" name="cate1" th:value="${selectC2.cate1}">	
               		<input type="hidden" name="cate2" th:value="${selectC2.cate2}">	
                </li>
            </ul>
			
			
            <ul class="depth4">
	            <li ng-hide="!isMedicalProduct()">
	                <strong class="tit">반려동물유형</strong>
	                <div class="con">
	                    <span>
	                        <input type="checkbox" name="dog" value="dog" checked="checked">
	                        <label for="dog">반려견</label>
	                    </span>
	                    <span>
	                        <input type="checkbox" name="cat" value="cat" checked="checked">
	                        <label for="cat">반려묘</label>
	                    </span>
	                </div>
	            </li>
	       </ul>
      </div>
      <div class="pro-lst" id="productList">
	        <div class="probx" th:each="product:${products}">
		            <a th:href="@{/product/view(cate1=${cate1},cate2=${cate2},prodNo=${product.prodNo})}">
		                <span class="thumb">
		                    <img th:src="${product.thumb1}" alt style="width:316px;height:320px;">
		                </span>
		                <div class="desc">
		                    <p class="org">[[${product.medicalName}]]</p>
		                    <p class="prd">[[${product.prodName}]]</p>
		                    <p class="txt">[[${product.descript}]]</p>
		                </div>
		            </a>
	                <div class="price">
	                    <div class="cost">
	                        <p class="sm">마이펫플러스 초대가</p>
	                        <th:block th:if="${product.discount != 0}">
	                        	<div class="oriPrice">
	                        		<span class="ori">[[${product.price}]]원</span>
	                        		<span class="discount">[[${product.discount}]]%</span>
	                        	</div>
	                        </th:block>
	                        <th:block th:if="${product.discount == 0}">
		                        <div class="disPrice">
		                        	<span>[[${product.price}]]원</span>
		                        </div>
	                        </th:block>
	                        <th:block th:if="${product.discount != 0}">
	                        	<div class="disPrice">
		                        	<span data-th-text="${#numbers.formatInteger(product.price*(100-product.discount)/100, 3, 'COMMA')}">
		                        	[[${#numbers.formatInteger(product.price*(100-product.discount)/100, 3)}]]원</span>
		                        </div>
	                        </th:block>                        
	                    </div>
	                </div>
	          </div>
	          
	         
	        
	  </div>
	  
	   <!-- 상품목록 페이지 번호 -->
       <div class="paging">
	       <th:block th:if="${groups[0]>1}">
	           <span class="prev"><a th:href="@{/product/list(cate1=${cate1},cate2=${cate2},pg=${groups[0]-1})}"><&nbsp;이전</a></span>
	       </th:block>
	       <th:block th:if="${groups[1] != 0}">
	       <th:block th:each="num:${#numbers.sequence(groups[0],groups[1])}">
	           <span class="num"><a th:href="@{/product/list(cate1=${cate1},cate2=${cate2},pg=${num})}" th:class="${num == currentPage?'num on':'num'}">[[${num}]]</a></span>
	       </th:block>
	       </th:block>
	       <th:block th:if="${groups[1]<lastPageNum}">
	           <span class="next"><a th:href="@{/product/list(cate1=${cate1},cate2=${cate2},pg=${groups[1] + 1})}">다음&nbsp;></a></span>
	       </th:block>
       </div>

   </div>    
            
            
   	 

</div>

<th:block th:include="@{product/_footer.html}"/>
